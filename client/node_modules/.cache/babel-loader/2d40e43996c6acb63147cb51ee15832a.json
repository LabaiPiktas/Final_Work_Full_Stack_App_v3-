{"ast":null,"code":"import React, { forwardRef, useRef, useState } from 'react';\nimport { useComponentDefaultProps } from '@mantine/styles';\nimport { useId, useUncontrolled, useMergedRef, clamp } from '@mantine/hooks';\nimport { RatingItem } from './RatingItem/RatingItem.js';\nimport useStyles from './Rating.styles.js';\nimport { Box } from '../Box/Box.js';\nvar __defProp = Object.defineProperty;\nvar __getOwnPropSymbols = Object.getOwnPropertySymbols;\nvar __hasOwnProp = Object.prototype.hasOwnProperty;\nvar __propIsEnum = Object.prototype.propertyIsEnumerable;\n\nvar __defNormalProp = (obj, key, value) => key in obj ? __defProp(obj, key, {\n  enumerable: true,\n  configurable: true,\n  writable: true,\n  value\n}) : obj[key] = value;\n\nvar __spreadValues = (a, b) => {\n  for (var prop in b || (b = {})) if (__hasOwnProp.call(b, prop)) __defNormalProp(a, prop, b[prop]);\n\n  if (__getOwnPropSymbols) for (var prop of __getOwnPropSymbols(b)) {\n    if (__propIsEnum.call(b, prop)) __defNormalProp(a, prop, b[prop]);\n  }\n  return a;\n};\n\nvar __objRest = (source, exclude) => {\n  var target = {};\n\n  for (var prop in source) if (__hasOwnProp.call(source, prop) && exclude.indexOf(prop) < 0) target[prop] = source[prop];\n\n  if (source != null && __getOwnPropSymbols) for (var prop of __getOwnPropSymbols(source)) {\n    if (exclude.indexOf(prop) < 0 && __propIsEnum.call(source, prop)) target[prop] = source[prop];\n  }\n  return target;\n};\n\nfunction roundValueTo(value, to) {\n  var _a;\n\n  const rounded = Math.round(value / to) * to;\n  const precision = ((_a = `${to}`.split(\".\")[1]) == null ? void 0 : _a.length) || 0;\n  return Number(rounded.toFixed(precision));\n}\n\nconst defaultProps = {\n  size: \"sm\",\n  getSymbolLabel: value => `${value}`,\n  count: 5,\n  fractions: 1,\n  color: \"yellow\"\n};\nconst Rating = forwardRef((props, ref) => {\n  const _a = useComponentDefaultProps(\"Rating\", defaultProps, props),\n        {\n    defaultValue,\n    value,\n    emptySymbol,\n    fullSymbol,\n    size,\n    count,\n    fractions,\n    onChange,\n    onHover,\n    getSymbolLabel,\n    name,\n    readOnly,\n    className,\n    classNames,\n    styles,\n    unstyled,\n    onMouseEnter,\n    onMouseMove,\n    onMouseLeave,\n    highlightSelectedOnly,\n    color,\n    id\n  } = _a,\n        others = __objRest(_a, [\"defaultValue\", \"value\", \"emptySymbol\", \"fullSymbol\", \"size\", \"count\", \"fractions\", \"onChange\", \"onHover\", \"getSymbolLabel\", \"name\", \"readOnly\", \"className\", \"classNames\", \"styles\", \"unstyled\", \"onMouseEnter\", \"onMouseMove\", \"onMouseLeave\", \"highlightSelectedOnly\", \"color\", \"id\"]);\n\n  const {\n    classes,\n    cx,\n    theme\n  } = useStyles(null, {\n    name: \"Rating\",\n    classNames,\n    styles,\n    unstyled\n  });\n\n  const _name = useId(name);\n\n  const _id = useId(id);\n\n  const rootRef = useRef(null);\n  const [_value, setValue] = useUncontrolled({\n    value,\n    defaultValue,\n    finalValue: 0,\n    onChange\n  });\n  const [hovered, setHovered] = useState(-1);\n  const [isOutside, setOutside] = useState(true);\n\n  const _fractions = Math.floor(fractions);\n\n  const _count = Math.floor(count);\n\n  const decimalUnit = 1 / _fractions;\n  const stableValueRounded = roundValueTo(_value, decimalUnit);\n  const finalValue = hovered !== -1 ? hovered : stableValueRounded;\n\n  const handleMouseEnter = event => {\n    onMouseEnter == null ? void 0 : onMouseEnter(event);\n    !readOnly && setOutside(false);\n  };\n\n  const handleMouseMove = event => {\n    onMouseMove == null ? void 0 : onMouseMove(event);\n\n    if (readOnly) {\n      return;\n    }\n\n    const {\n      left,\n      right,\n      width\n    } = rootRef.current.getBoundingClientRect();\n    const symbolWidth = width / _count;\n    const hoverPosition = theme.dir === \"rtl\" ? right - event.clientX : event.clientX - left;\n    const hoverValue = hoverPosition / symbolWidth;\n    const rounded = clamp(roundValueTo(hoverValue + decimalUnit / 2, decimalUnit), decimalUnit, _count);\n    setHovered(rounded);\n    rounded !== hovered && (onHover == null ? void 0 : onHover(rounded));\n  };\n\n  const handleMouseLeave = event => {\n    onMouseLeave == null ? void 0 : onMouseLeave(event);\n\n    if (readOnly) {\n      return;\n    }\n\n    setHovered(-1);\n    setOutside(true);\n    hovered !== -1 && (onHover == null ? void 0 : onHover(-1));\n  };\n\n  const handleItemBlur = () => isOutside && setHovered(-1);\n\n  const handleChange = event => {\n    const resultedValue = parseFloat(event.target.value);\n    setValue(resultedValue);\n  };\n\n  const items = Array(_count).fill(0).map((_, index) => {\n    const integerValue = index + 1;\n    const fractionItems = Array.from(new Array(index === 0 ? _fractions + 1 : _fractions));\n    const isGroupActive = !readOnly && Math.ceil(hovered) === integerValue;\n    return /* @__PURE__ */React.createElement(\"div\", {\n      key: integerValue,\n      \"data-active\": isGroupActive,\n      className: classes.symbolGroup\n    }, fractionItems.map((__, fractionIndex) => {\n      const fractionValue = decimalUnit * (index === 0 ? fractionIndex : fractionIndex + 1);\n      const symbolValue = roundValueTo(integerValue - 1 + fractionValue, decimalUnit);\n      return /* @__PURE__ */React.createElement(RatingItem, {\n        key: `${integerValue}-${symbolValue}`,\n        size,\n        getSymbolLabel,\n        emptyIcon: emptySymbol,\n        fullIcon: fullSymbol,\n        full: highlightSelectedOnly ? symbolValue === finalValue : symbolValue <= finalValue,\n        active: symbolValue === finalValue,\n        checked: symbolValue === stableValueRounded,\n        readOnly,\n        fractionValue,\n        value: symbolValue,\n        name: _name,\n        onChange: handleChange,\n        onBlur: handleItemBlur,\n        classNames,\n        styles,\n        unstyled,\n        color,\n        id: `${_id}-${index}-${fractionIndex}`\n      });\n    }));\n  });\n  return /* @__PURE__ */React.createElement(Box, __spreadValues({\n    ref: useMergedRef(rootRef, ref),\n    className: cx(classes.root, className),\n    onMouseMove: handleMouseMove,\n    onMouseEnter: handleMouseEnter,\n    onMouseLeave: handleMouseLeave\n  }, others), items);\n});\nRating.displayName = \"@mantine/core/Rating\";\nexport { Rating };","map":{"version":3,"mappings":"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","names":["__defProp","Object","defineProperty","__getOwnPropSymbols","getOwnPropertySymbols","__hasOwnProp","prototype","hasOwnProperty","__propIsEnum","propertyIsEnumerable","__defNormalProp","obj","key","value","enumerable","configurable","writable","__spreadValues","a","b","prop","call","__objRest","source","exclude","target","indexOf","roundValueTo","to","_a","rounded","Math","round","precision","split","length","Number","toFixed","defaultProps","size","getSymbolLabel","count","fractions","color","Rating","forwardRef","props","ref","useComponentDefaultProps","defaultValue","emptySymbol","fullSymbol","onChange","onHover","name","readOnly","className","classNames","styles","unstyled","onMouseEnter","onMouseMove","onMouseLeave","highlightSelectedOnly","id","others","classes","cx","theme","useStyles","_name","useId","_id","rootRef","useRef","_value","setValue","useUncontrolled","finalValue","hovered","setHovered","useState","isOutside","setOutside","_fractions","floor","_count","decimalUnit","stableValueRounded","handleMouseEnter","event","handleMouseMove","left","right","width","current","getBoundingClientRect","symbolWidth","hoverPosition","dir","clientX","hoverValue","clamp","handleMouseLeave","handleItemBlur","handleChange","resultedValue","parseFloat","items","Array","fill","map","_","index","integerValue","fractionItems","from","isGroupActive","ceil","React","createElement","symbolGroup","__","fractionIndex","fractionValue","symbolValue","RatingItem","emptyIcon","fullIcon","full","active","checked","onBlur","Box","useMergedRef","root","displayName"],"sources":["D:\\forum-system-with-react-novu-node\\client\\node_modules\\@mantine\\core\\src\\Rating\\Rating.tsx"],"sourcesContent":["import React, { forwardRef, useState, useRef } from 'react';\nimport {\n  DefaultProps,\n  MantineSize,\n  useComponentDefaultProps,\n  Selectors,\n  MantineColor,\n} from '@mantine/styles';\nimport { useUncontrolled, clamp, useMergedRef, useId } from '@mantine/hooks';\nimport { Box } from '../Box';\nimport { RatingItem, RatingItemStylesNames } from './RatingItem/RatingItem';\nimport useStyles from './Rating.styles';\n\nfunction roundValueTo(value: number, to: number) {\n  const rounded = Math.round(value / to) * to;\n  const precision = `${to}`.split('.')[1]?.length || 0;\n  return Number(rounded.toFixed(precision));\n}\n\nexport type RatingStylesNames = Selectors<typeof useStyles> | RatingItemStylesNames;\n\nexport interface RatingProps\n  extends DefaultProps<RatingStylesNames>,\n    Omit<React.ComponentPropsWithoutRef<'div'>, 'onChange'> {\n  /** Default value for uncontrolled component */\n  defaultValue?: number;\n\n  /** Value for controlled component */\n  value?: number;\n\n  /** Called when value changes */\n  onChange?(value: number): void;\n\n  /** The icon that is displayed when symbol is empty */\n  emptySymbol?: React.ReactNode | ((value: number) => React.ReactNode);\n\n  /** This icon that is displayed when symbol is full */\n  fullSymbol?: React.ReactNode | ((value: number) => React.ReactNode);\n\n  /** Number of fractions each item can be divided into, 1 by default */\n  fractions?: number;\n\n  /** Controls component size */\n  size?: MantineSize;\n\n  /** Number of controls that should be rendered */\n  count?: number;\n\n  /** Called when item is hovered */\n  onHover?(value: number): void;\n\n  /** Function should return labelText for the symbols */\n  getSymbolLabel?: (value: number) => string;\n\n  /** Name of rating, should be unique within the page */\n  name?: string;\n\n  /** If true, you won't be able to interact */\n  readOnly?: boolean;\n\n  /** If true, only the selected symbol will change to full symbol */\n  highlightSelectedOnly?: boolean;\n\n  /** Key of theme.colors or any CSS color value, yellow by default */\n  color?: MantineColor;\n}\n\nconst defaultProps: Partial<RatingProps> = {\n  size: 'sm',\n  getSymbolLabel: (value) => `${value}`,\n  count: 5,\n  fractions: 1,\n  color: 'yellow',\n};\n\nexport const Rating = forwardRef<HTMLInputElement, RatingProps>((props, ref) => {\n  const {\n    defaultValue,\n    value,\n    emptySymbol,\n    fullSymbol,\n    size,\n    count,\n    fractions,\n    onChange,\n    onHover,\n    getSymbolLabel,\n    name,\n    readOnly,\n    className,\n    classNames,\n    styles,\n    unstyled,\n    onMouseEnter,\n    onMouseMove,\n    onMouseLeave,\n    highlightSelectedOnly,\n    color,\n    id,\n    ...others\n  } = useComponentDefaultProps('Rating', defaultProps, props);\n\n  const { classes, cx, theme } = useStyles(null, { name: 'Rating', classNames, styles, unstyled });\n\n  const _name = useId(name);\n  const _id = useId(id);\n  const rootRef = useRef<HTMLDivElement>(null);\n\n  const [_value, setValue] = useUncontrolled({\n    value,\n    defaultValue,\n    finalValue: 0,\n    onChange,\n  });\n\n  const [hovered, setHovered] = useState(-1);\n  const [isOutside, setOutside] = useState(true);\n\n  const _fractions = Math.floor(fractions);\n  const _count = Math.floor(count);\n\n  const decimalUnit = 1 / _fractions;\n  const stableValueRounded = roundValueTo(_value, decimalUnit);\n  const finalValue = hovered !== -1 ? hovered : stableValueRounded;\n\n  const handleMouseEnter = (event: React.MouseEvent<HTMLDivElement>) => {\n    onMouseEnter?.(event);\n    !readOnly && setOutside(false);\n  };\n\n  const handleMouseMove = (event: React.MouseEvent<HTMLDivElement>) => {\n    onMouseMove?.(event);\n\n    if (readOnly) {\n      return;\n    }\n\n    const { left, right, width } = rootRef.current.getBoundingClientRect();\n    const symbolWidth = width / _count;\n\n    const hoverPosition = theme.dir === 'rtl' ? right - event.clientX : event.clientX - left;\n    const hoverValue = hoverPosition / symbolWidth;\n\n    const rounded = clamp(\n      roundValueTo(hoverValue + decimalUnit / 2, decimalUnit),\n      decimalUnit,\n      _count\n    );\n\n    setHovered(rounded);\n    rounded !== hovered && onHover?.(rounded);\n  };\n\n  const handleMouseLeave = (event: React.MouseEvent<HTMLDivElement>) => {\n    onMouseLeave?.(event);\n\n    if (readOnly) {\n      return;\n    }\n\n    setHovered(-1);\n    setOutside(true);\n    hovered !== -1 && onHover?.(-1);\n  };\n\n  const handleItemBlur = () => isOutside && setHovered(-1);\n\n  const handleChange = (event: React.ChangeEvent<HTMLInputElement>) => {\n    const resultedValue = parseFloat(event.target.value);\n    setValue(resultedValue);\n  };\n\n  const items = Array(_count)\n    .fill(0)\n    .map((_, index) => {\n      const integerValue = index + 1;\n      const fractionItems = Array.from(new Array(index === 0 ? _fractions + 1 : _fractions));\n      const isGroupActive = !readOnly && Math.ceil(hovered) === integerValue;\n\n      return (\n        <div key={integerValue} data-active={isGroupActive} className={classes.symbolGroup}>\n          {fractionItems.map((__, fractionIndex) => {\n            const fractionValue = decimalUnit * (index === 0 ? fractionIndex : fractionIndex + 1);\n            const symbolValue = roundValueTo(integerValue - 1 + fractionValue, decimalUnit);\n\n            return (\n              <RatingItem\n                key={`${integerValue}-${symbolValue}`}\n                size={size}\n                getSymbolLabel={getSymbolLabel}\n                emptyIcon={emptySymbol}\n                fullIcon={fullSymbol}\n                full={\n                  highlightSelectedOnly ? symbolValue === finalValue : symbolValue <= finalValue\n                }\n                active={symbolValue === finalValue}\n                checked={symbolValue === stableValueRounded}\n                readOnly={readOnly}\n                fractionValue={fractionValue}\n                value={symbolValue}\n                name={_name}\n                onChange={handleChange}\n                onBlur={handleItemBlur}\n                classNames={classNames}\n                styles={styles}\n                unstyled={unstyled}\n                color={color}\n                id={`${_id}-${index}-${fractionIndex}`}\n              />\n            );\n          })}\n        </div>\n      );\n    });\n\n  return (\n    <Box\n      ref={useMergedRef(rootRef, ref)}\n      className={cx(classes.root, className)}\n      onMouseMove={handleMouseMove}\n      onMouseEnter={handleMouseEnter}\n      onMouseLeave={handleMouseLeave}\n      {...others}\n    >\n      {items}\n    </Box>\n  );\n});\n\nRating.displayName = '@mantine/core/Rating';\n"]},"metadata":{},"sourceType":"module"}